/*
 *****************************************************************************
 Copyright (c) Microsoft Corporation. All rights reserved.
 Licensed under the Apache License, Version 2.0 (the "License"); you may not use
 this file except in compliance with the License. You may obtain a copy of the
 License at http://www.apache.org/licenses/LICENSE-2.0

 THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
 WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
 MERCHANTABLITY OR NON-INFRINGEMENT.

 See the Apache Version 2.0 License for specific language governing permissions
 and limitations under the License.
*****************************************************************************/
var n=this;
function p(){function q(d,e,g,f){return new (g||(g=Promise))(function(c,m){function h(a){try{l(f.next(a))}catch(k){m(k)}}function b(a){try{l(f["throw"](a))}catch(k){m(k)}}function l(a){a.done?c(a.value):(new g(function(k){k(a.value)})).then(h,b)}l((f=f.apply(d,e||[])).next())})}function r(d,e){function g(a){return function(k){return f([a,k])}}function f(a){if(m)throw new TypeError("Generator is already executing.");for(;c;)try{if(m=1,h&&(b=a[0]&2?h["return"]:a[0]?h["throw"]||((b=h["return"])&&b.call(h),
0):h.next)&&!(b=b.call(h,a[1])).done)return b;if(h=0,b)a=[a[0]&2,b.value];switch(a[0]){case 0:case 1:b=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++;h=a[1];a=[0];continue;case 7:a=c.a.pop();c.b.pop();continue;default:if(!(b=c.b,b=0<b.length&&b[b.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!b||a[1]>b[0]&&a[1]<b[3]))c.label=a[1];else if(6===a[0]&&c.label<b[1])c.label=b[1],b=a;else if(b&&c.label<b[2])c.label=b[2],c.a.push(a);else{b[2]&&c.a.pop();c.b.pop();continue}}a=
e.call(d,c)}catch(k){a=[6,k],h=0}finally{m=b=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var c={label:0,g:function(){if(b[0]&1)throw b[1];return b[1]},b:[],a:[]},m,h,b,l;return l={next:g(0),"throw":g(1),"return":g(2)},"function"===typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l}return function(){function d(e,g){this.state=d.NONE;this.link=document.createElement("a");e&&this.update(e,g)}d.prototype.update=function(e,g){return q(this,void 0,void 0,function(){var f=this;
return r(this,function(){this.link.download=g||"download";this.state=d.PROGRESSING;return"string"===typeof e?[2,fetch(e).then(function(c){return c.blob()}).then(function(c){f.c(c);return f}).catch(function(c){f.state=d.ERROR;console.error(c);return f})]:[2,Promise.resolve(this.c(e))]})})};d.prototype.download=function(e){e&&(this.link.download=e);this.state===d.READY?this.link.click():console.error("The file hasn't been ready.");return this};d.download=function(e,g){return q(this,void 0,void 0,function(){var f;
return r(this,function(c){switch(c.label){case 0:return f=d.instance,[4,f.update(e)];case 1:return c.g(),[2,f.download(g)]}})})};d.prototype.c=function(e){this.state=d.READY;this.blob=e;this.f=URL.createObjectURL(e);this.link.href=this.f;return this};d.READY=1;d.NONE=0;d.ERROR=-1;d.PROGRESSING=2;d.instance=new d;return d}()}"object"===typeof exports&&"undefined"!==typeof module?module.i=p():"function"===typeof define&&define.h?define(p):(n=n||self,n.BlobDownloader=p());
